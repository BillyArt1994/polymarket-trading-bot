# è™šæ‹Ÿç›˜æµ‹è¯•æŒ‡å—

æœ¬æ–‡æ¡£ä»‹ç»å¦‚ä½•ä½¿ç”¨è™šæ‹Ÿç›˜ï¼ˆå›žæµ‹ï¼‰åŠŸèƒ½æµ‹è¯•äº¤æ˜“ç­–ç•¥ï¼Œæ— éœ€çœŸå®žèµ„é‡‘ã€‚

## ðŸŽ¯ ä»€ä¹ˆæ˜¯è™šæ‹Ÿç›˜æµ‹è¯•ï¼Ÿ

è™šæ‹Ÿç›˜æµ‹è¯•ä½¿ç”¨åŽ†å²ä»·æ ¼æ•°æ®æˆ–æ¨¡æ‹Ÿæ•°æ®æ¥éªŒè¯ç­–ç•¥çš„æœ‰æ•ˆæ€§ï¼Œè®¡ç®—å‡è®¾æ‰§è¡Œäº¤æ˜“åŽçš„ç›ˆäºæƒ…å†µã€‚

**ä¼˜ç‚¹ï¼š**
- âœ… é›¶é£Žé™©æµ‹è¯•ç­–ç•¥
- âœ… å¿«é€ŸéªŒè¯ç­–ç•¥é€»è¾‘
- âœ… å¯ä»¥æµ‹è¯•å¤šç§åœºæ™¯
- âœ… ç”Ÿæˆè¯¦ç»†çš„å›žæµ‹æŠ¥å‘Š

---

## ðŸš€ å¿«é€Ÿå¼€å§‹

### 1. è¿è¡Œé»˜è®¤å›žæµ‹ï¼ˆéšæœºåœºæ™¯ï¼Œ7å¤©æ•°æ®ï¼‰

```bash
npm run backtest
```

### 2. æµ‹è¯•ç‰¹å®šåœºæ™¯

**å¿«é€Ÿå›žå½’åœºæ™¯**ï¼ˆä»·æ ¼å¿«é€Ÿå›žåˆ°å‡è¡¡ï¼‰ï¼š
```bash
npm run backtest:quick
```

**æ…¢é€Ÿå›žå½’åœºæ™¯**ï¼ˆä»·æ ¼ç¼“æ…¢å›žå½’ï¼‰ï¼š
```bash
npm run backtest:slow
```

**å¤šå¸‚åœºéšæœºæµ‹è¯•**ï¼š
```bash
npm run backtest:random
```

### 3. è‡ªå®šä¹‰å‚æ•°

```bash
# 14å¤©æ•°æ®ï¼Œ5ä¸ªå¸‚åœº
npm run backtest -- --days=14 --markets=5

# ç‰¹å®šåœºæ™¯æµ‹è¯•
npm run backtest -- --scenario=QUICK_RETURN --days=3

# ä¿å­˜æŠ¥å‘Šåˆ°æŒ‡å®šè·¯å¾„
npm run backtest -- --output=./my-report.json
```

---

## ðŸ“Š æµ‹è¯•åœºæ™¯è¯´æ˜Ž

| åœºæ™¯ | è¯´æ˜Ž | é€‚ç”¨æµ‹è¯• |
|------|------|---------|
| **QUICK_RETURN** | ä»·æ ¼åç¦»åŽå¿«é€Ÿå›žå½’ï¼ˆ20ä¸ªç‚¹å†…ï¼‰ | æµ‹è¯•æ­¢ç›ˆç­–ç•¥ |
| **SLOW_RETURN** | ä»·æ ¼ç¼“æ…¢å›žå½’ï¼ˆ60ä¸ªç‚¹å†…ï¼‰ | æµ‹è¯•æŒä»“è€å¿ƒ |
| **NO_RETURN** | ä»·æ ¼æŒç»­åç¦» | æµ‹è¯•æ­¢æŸ/è¶…æ—¶é€»è¾‘ |
| **WORSEN** | åç¦»åº¦é€æ¸æ‰©å¤§ | æµ‹è¯•æžç«¯æƒ…å†µå¤„ç† |
| **RANDOM** | å¤šå¸‚åœºéšæœºæ³¢åŠ¨ | ç»¼åˆç­–ç•¥è¯„ä¼° |

---

## ðŸ“ˆ å›žæµ‹æŠ¥å‘Šè§£è¯»

è¿è¡Œå›žæµ‹åŽä¼šç”Ÿæˆ JSON æŠ¥å‘Šï¼ŒåŒ…å«ä»¥ä¸‹å…³é”®æŒ‡æ ‡ï¼š

### æ ¸å¿ƒæŒ‡æ ‡

```json
{
  "totalTrades": 15,           // æ€»äº¤æ˜“æ¬¡æ•°
  "winningTrades": 10,         // ç›ˆåˆ©æ¬¡æ•°
  "losingTrades": 5,           // äºæŸæ¬¡æ•°
  "winRate": 66.67,            // èƒœçŽ‡ (%)
  "totalPnL": 45.50,           // æ€»ç›ˆäº (USD)
  "totalPnLPercent": 4.55,     // æ€»ç›ˆäºçŽ‡ (%)
  "avgReturn": 1.52,           // å¹³å‡æ”¶ç›ŠçŽ‡ (%)
  "maxDrawdown": 3.21,         // æœ€å¤§å›žæ’¤ (%)
  "sharpeRatio": 1.85          // å¤æ™®æ¯”çŽ‡
}
```

### æŒ‡æ ‡è§£è¯»

| æŒ‡æ ‡ | è‰¯å¥½ | ä¸€èˆ¬ | è¾ƒå·® |
|------|------|------|------|
| **èƒœçŽ‡** | > 60% | 50-60% | < 50% |
| **æ€»ç›ˆäºçŽ‡** | > 5% | 0-5% | < 0% |
| **æœ€å¤§å›žæ’¤** | < 5% | 5-10% | > 10% |
| **å¤æ™®æ¯”çŽ‡** | > 1.5 | 1-1.5 | < 1 |

---

## ðŸŽ® å®žæˆ˜æµ‹è¯•å»ºè®®

### é˜¶æ®µ1ï¼šå•ä¸€åœºæ™¯æµ‹è¯•

å…ˆæµ‹è¯•å•ä¸ªåœºæ™¯ï¼ŒéªŒè¯ç­–ç•¥é€»è¾‘æ˜¯å¦æ­£ç¡®ï¼š

```bash
# æµ‹è¯•å¿«é€Ÿå›žå½’åœºæ™¯
npm run backtest -- --scenario=QUICK_RETURN

# è§‚å¯Ÿæ˜¯å¦èƒ½æ­£ç¡®æ•æ‰åˆ°å›žå½’åˆ©æ¶¦
```

### é˜¶æ®µ2ï¼šå¤šåœºæ™¯å¯¹æ¯”

æµ‹è¯•ä¸åŒåœºæ™¯ä¸‹ç­–ç•¥çš„è¡¨çŽ°ï¼š

```bash
# å¿«é€Ÿå›žå½’
npm run backtest -- --scenario=QUICK_RETURN --output=quick.json

# æ…¢é€Ÿå›žå½’
npm run backtest -- --scenario=SLOW_RETURN --output=slow.json

# å¯¹æ¯”ä¸¤ä¸ªæŠ¥å‘Šçš„å·®å¼‚
```

### é˜¶æ®µ3ï¼šé•¿æœŸéšæœºæµ‹è¯•

æ¨¡æ‹ŸçœŸå®žå¸‚åœºçŽ¯å¢ƒï¼š

```bash
# 30å¤©ï¼Œ10ä¸ªå¸‚åœº
npm run backtest -- --days=30 --markets=10 --output=longterm.json
```

### é˜¶æ®µ4ï¼šå‚æ•°ä¼˜åŒ–

æ ¹æ®å›žæµ‹ç»“æžœè°ƒæ•´ç­–ç•¥å‚æ•°ï¼š

```bash
# æµ‹è¯•ä¸åŒçš„åç¦»åº¦é˜ˆå€¼
# ä¿®æ”¹ src/config/index.ts ä¸­çš„ minArbitrageGap
# ç„¶åŽé‡æ–°è¿è¡Œå›žæµ‹
```

---

## ðŸ”§ é«˜çº§ç”¨æ³•

### è‡ªå®šä¹‰æµ‹è¯•æ•°æ®

ä½ å¯ä»¥ä¿®æ”¹ `src/services/execution/mockDataGenerator.ts` æ¥ç”Ÿæˆç‰¹å®šçš„ä»·æ ¼æ¨¡å¼ï¼š

```typescript
// æ·»åŠ è‡ªå®šä¹‰åœºæ™¯
static generateCustomScenario(...): HistoricalPrice[] {
  // ä½ çš„è‡ªå®šä¹‰é€»è¾‘
}
```

### ä½¿ç”¨çœŸå®žåŽ†å²æ•°æ®

å¦‚æžœä½ æœ‰ Polymarket çš„åŽ†å²æ•°æ®ï¼Œå¯ä»¥åœ¨ `backtest.ts` ä¸­æ›¿æ¢æ¨¡æ‹Ÿæ•°æ®ï¼š

```typescript
// ä»Žæ–‡ä»¶åŠ è½½çœŸå®žæ•°æ®
const priceData = loadHistoricalDataFromFile('./historical-data.json');
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ»‘ç‚¹æœªè€ƒè™‘**ï¼šå›žæµ‹å‡è®¾ä»¥å½“å‰ä»·æ ¼æˆäº¤ï¼Œå®žé™…å¯èƒ½æœ‰æ»‘ç‚¹
2. **Gasè´¹ä¼°ç®—**ï¼šå½“å‰æŒ‰å›ºå®š0.5%ä¼°ç®—ï¼Œå®žé™…å¯èƒ½ä¸åŒ
3. **æµåŠ¨æ€§å‡è®¾**ï¼šå‡è®¾æ‰€æœ‰è®¢å•éƒ½èƒ½æˆäº¤ï¼Œå®žé™…å¯èƒ½å—æµåŠ¨æ€§é™åˆ¶
4. **è¿‡åŽ»ä¸ä»£è¡¨æœªæ¥**ï¼šå›žæµ‹è¡¨çŽ°å¥½ä¸ä»£è¡¨å®žç›˜ä¸€å®šç›ˆåˆ©

---

## ðŸ“ ç¤ºä¾‹è¾“å‡º

```
ðŸ”„ Polymarket è™šæ‹Ÿç›˜å›žæµ‹
========================================
å›žæµ‹å¤©æ•°: 7
æµ‹è¯•åœºæ™¯: RANDOM
å¸‚åœºæ•°é‡: 3
========================================

ðŸ“Š ç”Ÿæˆä»·æ ¼æ•°æ®: 6048 ä¸ªç‚¹

[å›žæµ‹] 2024-02-08T10:00:00.000Z å‘çŽ°ä¿¡å· #1 åç¦»åº¦: 3.25%
[è™šæ‹Ÿäº¤æ˜“] #1 ä¹°å…¥ YES $223 @ $0.6240
[å›žæµ‹] 2024-02-08T10:45:00.000Z å‘çŽ°ä¿¡å· #2 åç¦»åº¦: 4.12%
...
[è™šæ‹Ÿå¹³ä»“] #1 FULL_CLOSE ç›ˆäº: $6.45 (2.89%)

========================================
ðŸ“Š å›žæµ‹æŠ¥å‘Š
========================================
æ€»äº¤æ˜“æ•°: 15
ç›ˆåˆ©äº¤æ˜“: 10
äºæŸäº¤æ˜“: 5
èƒœçŽ‡: 66.67%
æ€»ç›ˆäº: $45.50 (4.55%)
å¹³å‡æ”¶ç›Š: 1.52%
æœ€å¤§å›žæ’¤: 3.21%
å¤æ™®æ¯”çŽ‡: 1.85
========================================

ðŸ“ äº¤æ˜“æ˜Žç»†:
  ðŸŸ¢ #1 Test Market 1 YES ç›ˆäº: $6.45
  ðŸŸ¢ #2 Test Market 2 NO ç›ˆäº: $8.23
  ðŸ”´ #3 Test Market 1 YES ç›ˆäº: -$2.10
  ...

âœ… å›žæµ‹æŠ¥å‘Šå·²ä¿å­˜: ./backtest-report.json

ðŸ“ˆ ç­–ç•¥è¯„ä¼°:
ðŸŸ¢ ç­–ç•¥è¡¨çŽ°è‰¯å¥½ï¼Œå¯è€ƒè™‘å®žç›˜æµ‹è¯•
```

---

## ðŸ¤” å¸¸è§é—®é¢˜

**Q: å›žæµ‹ç»“æžœå¥½ï¼Œå®žç›˜ä¸€å®šå¥½å—ï¼Ÿ**
A: ä¸ä¸€å®šã€‚å›žæµ‹æœ‰å¾ˆå¤šå‡è®¾ï¼ˆæ— æ»‘ç‚¹ã€å³æ—¶æˆäº¤ç­‰ï¼‰ï¼Œå®žç›˜ä¼šæœ‰å·®å¼‚ã€‚

**Q: éœ€è¦è·‘å¤šå°‘æ¬¡å›žæµ‹ï¼Ÿ**
A: å»ºè®®è‡³å°‘è·‘10æ¬¡éšæœºåœºæ™¯ï¼Œå–å¹³å‡å€¼ä½œä¸ºå‚è€ƒã€‚

**Q: å¦‚ä½•ä¿å­˜å¯¹æ¯”ä¸åŒå‚æ•°çš„ç»“æžœï¼Ÿ**
A: ä½¿ç”¨ `--output` å‚æ•°ä¿å­˜ä¸åŒæŠ¥å‘Šï¼Œç„¶åŽç”¨å·¥å…·å¯¹æ¯”ï¼š
```bash
npm run backtest -- --output=report-v1.json
# ä¿®æ”¹å‚æ•°åŽ
npm run backtest -- --output=report-v2.json
```

---

## ðŸ“š ç›¸å…³æ–‡ä»¶

- `src/backtest.ts` - å›žæµ‹å…¥å£
- `src/services/execution/backtestEngine.ts` - å›žæµ‹å¼•æ“Ž
- `src/services/execution/virtualExecutor.ts` - è™šæ‹Ÿäº¤æ˜“æ‰§è¡Œ
- `src/services/execution/mockDataGenerator.ts` - æ¨¡æ‹Ÿæ•°æ®ç”Ÿæˆ
